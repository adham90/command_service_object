# frozen_string_literal: true

module <%= service_name.classify %>::Usecases
  class <%= @usecase %> < CaseBase
    #
    # Your business logic goes here, keep [call] method clean by using private
    # methods for Business logic.
    #
    def call
      # Use check! for business logic validation,
      # If the given block returns false then it will raise a business logic failure with the given message.
      # Ex: check!("user should not have any active cards") { cmd.issuer.active_cards.empty? }

      replace_me

      output
    end

    def output
      # return entity object
    end

    # This method will run if call method raise error
    def rollback
      # rollback logic
    end

    def allowed?
      # policies loginc for issuer
      # ex:
      #
      #   return false if issuer.role != :admin

      true
    end

    def broadcast
      Hutch.publish('<%= service_name %>', action: '<%= "#{@usecase.underscore}" %>', subject: {})
    end

    private

    def replace_me
      # [business logic]
    end
  end
end
